<!doctype html>
<html>
<head>
    <title>clockwizz</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link id="luckiestFont" href="https://fonts.googleapis.com/css?family=Luckiest+Guy" rel="stylesheet">
    <link id="demoStyles" rel="stylesheet" type="text/css" href="demoStyles.css">
    <style>
        clockwizz {
            user-select: none;
        }
    </style>
    <script defer id="wizzScript" src="clockwizz.js"
     data-wizz='{
        "touchEventName" : "touchwizz",
        "mouseEventName" : "mousewizz"
     }'
    ></script>
</head>
<body>

    <div id="holder">
    <div
     id="sceneDiv"
     class="clockwizz"
     data-wizz
     data-wizzXXX='{
         "mouseEventName" : "wizzer"
     }'
    >
        <div id="heartDiv">
            <svg id="heartSVG" transform="scale(0)" style="right:50px;bottom:20px;border:0px solid #fff;" height="200px" width="200px" xmlns="http://www.w3.org/2000/svg">
                <path class="Xpath" fill="#a20" stroke="rgba(50, 10, 0, 0.95)" stroke-width="10" style="transform-origin:50% 50%" transform="rotate(-35 0 0) translate(30 5)" d="
M 0 150
A 500 500 0 0 0 0 50
A 30 30 0 0 1 100 50
A 30 30 0 0 1 100 150
A 500 500 0 0 0 0 150
Z
                "/>
            </svg>
        </div>

        <img id="hackbox" src="hackBox0.svg">
        
        <div id="shadow" style="
            position: absolute;
            left: 40px;
            top: 282px;
            height: 5px;
            width: 100px;
            background-color: rgba(70, 30, 0, 0.2);
            border-radius: 50%;
        "></div>
        <div id="queviva"
         class="qr"
         style="
            font-family:'luckiest guy';
            text-align:right;
            bottom:0px;
            position: absolute;
            width: 100%;
            user-select: none;
            color: rgba(56, 11, 0, 1);
        ">
            <i>~queviva</i>
        </div>
        
    </div>
        <div class="qr">
            make a circular motion, while touching or pressing,
            on the image above
        </div>
        <div class="qr">
            <b>clockwizz</b> adds a <i>clockwise motion event</i>
            to any of the specified elements in a page;
            listen for, and handle them, in the same way
            you would any event.
        </div>
        <div class="qr">
            include the script in a deferred script tag,
            along with any optional parameters
        </div>
        <div class="qr">
            <pre>
                
&lt;script defer src="clockwizz.js"
 data-wizz='{
    "touchEventName" : "touchwizz",
    "mouseEventName" : "mousewizz",
    "selector" : "wizz"
 }'
&gt;&lt;/script&gt;
            </pre>
        </div>
        <div class="qr">
            the "touchEventName" can be customized to
            whatever you would like - the default name
            for the clockwise touch event is "touchwizz"
            <br><br>
            same with the clockwise mouse motion event
            <br><br>
            the "selector" is what the script will use
            to identify the elements that you would like
            to add clockwizz events to - this is done by
            giving that element a "data-wizz" parameter
            <br><br>
            any options can also be added in the data-wizz
            parameter
        </div>
        <div class="qr">
            the simplest example would be to just include
            the script and use all default parameters -
	    the name of the script must contain 'clockwizz'
            and end with '.js' 
            <br><br>
            <pre>
                
&lt;script defer src="clockwizz.min.js"&gt;

&lt;div id="sampleDiv" data-wizz&gt;
...
&lt;/div&gt;

&lt;script&gt;

    document.getElementById('sampleDiv')
    .addEventListener(
        'touchwizz',
        e => {
            // handle clockwise motion using
            // e.detail.direction
            // for the direction of the turning, and
            // e.detail.mag
            // for the magnitude of the turning
        }
    );
        
&lt;/script&gt;

            </pre>
        </div>
    
        <div class="qr">
            the touch|mousewizz event's detail includes a
            <i>direction</i>, which is either -1, 0, or 1
            and a <i>mag</i> giving the magnitude - in pixels -
            of the size of the movement
            <br><br>
            <pre>
                
 e.detail.direction = ...
     1 ::: clockwise
     0 ::: no turning
    -1 ::: counter-clockwise
    
 e.detail.mag = ...
    size, in pixels, of the turning
    
            </pre>
        </div>
        <div class="qr">
            data-param tags can be used to customize
            the event names - the following will give
            an event named <i>touchClockTurn</i> and
            an event named <i>moustClockTurn</i> to
            any tag that contains a <i>data-clocker</i> parameter;
            <i>clockDiv2</i> creates its own specific event name
            - called 'div2clock' - using the data-param to
            override the new default created by the
            script tag
            <br><br>
            <pre>
                
&lt;script defer src="clockwizz.js"
 data-wizz='{
    "touchEventName" : "touchClockTurn",
    "mouseEventName" : "mouseClockTurn",
    "selector" : "clocker"
 }'
&gt;&lt;/script&gt;

&lt;div id="clockDiv0" data-clocker&gt; ... &lt;/div&gt;
&lt;div id="clockDiv1" data-clocker&gt; ... &lt;/div&gt;
&lt;div id="clockDiv2"
 class="specialSauce"
 data-clocker='{
    "touchEventName" : "div2clock"
 }'
&gt;
 ...
&lt;/div&gt;

&lt;script&gt;

    document.getElementById('clockDiv0')
        .addEventListener('touchwizz', e => { // ... });
        
    document.getElementById('clockDiv2')
        .addEventListener('div2clock', e => { // ... });
        
        
&lt;/script&gt;

            </pre>
        </div>
        <div class="qr">
            <ul>
                
            <li>include the defer script</li>
            <li>add data-wizz parameter to tags</li>
            <li>handle wizz events as usual</li>
            </ul>
        </div>
    
    </div>


</body>
<script id="demoScript">

window.addEventListener('load', e => {
    
    const HB = document.getElementById('hackbox');
    const hold = document.getElementById('sceneDiv');
    const hrt = document.getElementById('heartSVG');
    const shad = document.getElementById('shadow');
    const que = document.getElementById('queviva');
    
    let
        HBcs = window.getComputedStyle(HB),
        HBw = parseInt(HBcs.width, 10),
        holdWidth = parseInt(window.getComputedStyle(hold).width, 10),
        WW = holdWidth + HBw,
        left = HBw + parseInt(HBcs.left, 10),
        pulse = 1,
        xL = WW - 120, yL = -100,
        xB = left, yB = 200,
        xS = 0, yS = 280;
        
    const woggle = e => {
        left = (((left + ((e.detail.mag/5) * e.detail.direction * 2)) % WW) + WW) % WW;
        HB.style.left = -HBw + left +'px';
        xB = -HBw + left + 60;
        hrt.setAttributeNS(null,'transform', 'scale('+
            (0.0 + (3 * ((Math.abs(((left * pulse) % WW) - (WW/2)))/WW)))
        +')');
        
        // calculate the shadow x position
        let theta1 = -Math.atan2(
            yB - yL,
            xB - xL
        );
        let mag1 = 80 / Math.sin(theta1);
        xS = mag1 * Math.cos(theta1);
        shad.style.left = xB - xS + 'px';
        
        // calculate the shadow width
        let theta2 = -Math.atan2(
            yB - yL,
            (xB + 140) - xL
        );
        let mag2 = 80 / Math.sin(theta2);
        let xSS = mag2 * Math.cos(theta2);
        shad.style.width = 140 - xSS + xS +'px';
        
        e.preventDefault();
        e.stopPropagation();
        
    };
    
    hold.addEventListener('mousewizz', woggle, { passive: false });
    hold.addEventListener('touchwizz', woggle, { passive: false });
    
    woggle(new CustomEvent('mousewizz', {detail:{direction:0, mag:0}}));
    
    window.addEventListener('resize', e => {
        HBcs = window.getComputedStyle(HB);
        HBw = parseInt(HBcs.width, 10);
        WW = parseInt(window.getComputedStyle(hold).width, 10) + HBw;
        left = HBw + parseInt(HBcs.left, 10);
        woggle(new CustomEvent('wizz', {detail:{direction:0, mag: 0}}));
    });
    
    let toggleListener = 0;
    que.addEventListener('dblclick', e => {
        hold[++toggleListener % 2 === 1 ? 'removeEventListener' : 'addEventListener']('mousewizz', woggle, { passive: false });
        hold[  toggleListener % 2 === 1 ? 'removeEventListener' : 'addEventListener']('touchwizz', woggle, { passive: false });
    });

});




</script>
</html>
